local.verifio.email {
    tls internal

    # Frontend routes (most specific first)
    handle /dashboard* {
        reverse_proxy host.docker.internal:3001 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    handle /docs* {
        reverse_proxy host.docker.internal:3003 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    handle /blog* {
        reverse_proxy host.docker.internal:3004 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }

    # API routes (backend services on ports 8000-8006)
    handle /api/auth* {
        reverse_proxy host.docker.internal:8000 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    handle /api/verify* {
        reverse_proxy host.docker.internal:8001 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    handle /api/api-key* {
        reverse_proxy host.docker.internal:8002 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    handle /api/logs* {
        reverse_proxy host.docker.internal:8003 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    handle /api/upload* {
        reverse_proxy host.docker.internal:8004 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    handle /api/credits* {
        reverse_proxy host.docker.internal:8005 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    handle /api/tools* {
        reverse_proxy host.docker.internal:8006 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
    # Main app (catch-all - everything else)
    handle {
        reverse_proxy host.docker.internal:3000 {
            header_up Host {host}
            header_up X-Forwarded-Proto {scheme}
            header_up X-Forwarded-For {remote}
        }
    }
}
