---
title: Authentication & Security
description: Authentication methods and security best practices.
---

# Authentication & Security

Authentication methods and security implementation.

## Authentication Methods

### 1. Session-Based Authentication

**Used by:** Dashboard users

```typescript
const response = await fetch('https://api.verifio.email/api/endpoint', {
  credentials: 'include',  // Include session cookie
});
```

**Session Cookie Properties:**
- `httpOnly: true` - Prevents XSS
- `secure: true` - HTTPS only
- `sameSite: 'lax'` - CSRF protection
- `maxAge: 604800` - 7 days

### 2. API Key Authentication

**Used by:** Programmatic access

```typescript
const response = await fetch('https://api.verifio.email/api/endpoint', {
  headers: {
    'Authorization': 'Bearer rl_your_api_key',
  },
});
```

**Or:**
```typescript
headers: {
  'X-API-Key': 'rl_your_api_key',
}
```

## Authorization

**Organization-Based Access Control:**

| Role | Permissions |
|------|-------------|
| `owner` | Full access, can delete org |
| `admin` | Manage members, API keys |
| `member` | Use services, view logs |

## Rate Limiting

| Type | Limit | Window |
|------|-------|--------|
| IP | 10 requests | 1 minute |
| Fingerprint | 15 requests | 1 minute |
| Email | 5 requests | 15 minutes |
| API Key | Configurable | Configurable |

## Security Checklist

- [ ] All services use HTTPS in production
- [ ] Session cookies are HttpOnly and Secure
- [ ] API keys hashed in database
- [ ] Rate limiting enabled
- [ ] Input validation on all inputs
- [ ] SQL injection prevented (ORM)
- [ ] XSS protection (CSP)
- [ ] CSRF protection (SameSite)
- [ ] OAuth tokens encrypted
- [ ] Audit logging enabled

## Best Practices

### API Keys

- **Never** commit to version control
- **Store** in environment variables
- **Rotate** regularly (every 90 days)
- **Use** minimal required permissions

### Sessions

- **Short** expiration (7 days)
- **Secure** cookie settings
- **Destroy** on logout

### Data Protection

- **Never** log sensitive data
- **Sanitize** error messages
- **Validate** all inputs
- **Encrypt** data at rest
